USE TREINAMENTO



CREATE TABLE TAB_FATURAMENTO
(DATA_VENDA  DATE NULL,
TOTAL_VENDA FLOAT);


SELECT 
TV.DATA_VENDA,
SUM (TIV.QUANTIDADE * TIV.PRECO) AS TOTAL_VENDA
FROM TABELA_DE_VENDAS TV
INNER JOIN TABELA_DE_ITENS_VENDIDOS TIV
ON TV.NUMERO = TIV.NUMERO
GROUP BY
TV.DATA_VENDA

SELECT * FROM CLIENTES;
SELECT * FROM PRODUTOS;


INSERT INTO TABELA_DE_VENDAS
VALUES('0101', '2018-05-15', '1471156710', '235', 0.18);

INSERT INTO TABELA_DE_ITENS_VENDIDOS
VALUES ('0101','1040112',100, 10 );


DELETE FROM TAB_FATURAMENTO;
INSERT INTO TAB_FATURAMENTO
SELECT 
TV.DATA_VENDA,
SUM (TIV.QUANTIDADE * TIV.PRECO) AS TOTAL_VENDA
FROM TABELA_DE_VENDAS TV
INNER JOIN TABELA_DE_ITENS_VENDIDOS TIV
ON TV.NUMERO = TIV.NUMERO
GROUP BY
TV.DATA_VENDA
SELECT * FROM TAB_FATURAMENTO;


INSERT INTO TABELA_DE_VENDAS
VALUES('0102', '2018-05-15', '1471156710', '235', 0.18);
INSERT INTO TABELA_DE_ITENS_VENDIDOS
VALUES ('0102','1040112',100, 10 );



SELECT * FROM TAB_FATURAMENTO;

INSERT INTO TABELA_DE_VENDAS
VALUES('0105', '2018-05-16', '1471156710', '235', 0.18);
INSERT INTO TABELA_DE_ITENS_VENDIDOS
VALUES ('0105','1040112',100, 10 );

DELETE FROM TAB_FATURAMENTO;
INSERT INTO TAB_FATURAMENTO
SELECT 
TV.DATA_VENDA,
SUM (TIV.QUANTIDADE * TIV.PRECO) AS TOTAL_VENDA
FROM TABELA_DE_VENDAS TV
INNER JOIN TABELA_DE_ITENS_VENDIDOS TIV
ON TV.NUMERO = TIV.NUMERO
GROUP BY
TV.DATA_VENDA
SELECT * FROM TAB_FATURAMENTO;


INSERT INTO TABELA_DE_VENDAS
VALUES('0107', '2018-05-16', '1471156710', '235', 0.18);
INSERT INTO TABELA_DE_ITENS_VENDIDOS
VALUES ('0107','1040112',150, 10 );

UPDATE TABELA_DE_ITENS_VENDIDOS SET QUANTIDADE = 200 WHERE NUMERO ='0106'

DELETE FROM TABELA_DE_ITENS_VENDIDOS WHERE NUMERO ='0106'